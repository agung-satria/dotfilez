#!/bin/bash

function send_notification() {
	# volume=$(pamixer --get-volume)
  active_sink=$(pacmd list-sinks | awk '/* index:/{print $3}')
  curStatus=$(pacmd list-sinks | grep -A 15 "index: $active_sink$" | awk '/muted/{ print $2}')
  volume=$(awk -F"[][]" '/Left:/ { print $2 }' <(amixer sget Master))

	# volume=$(pacmd list-sinks | grep -A 15 "index: pacmd list-sinks | awk '/* index:/{print $3}'$" | grep 'volume:' | grep -E -v 'base volume:' | awk -F : '{print $3}' | grep -o -P '.{0,3}%'| sed s/.$// | tr -d ' ')
	dunstify -a "changevolume" -u low -r "9993" -h int:value:"$volume" -i "volume-$1" "Volume: ${volume}" -t 2000
}

case $1 in
up)
  amixer -q -D pulse sset Master 5%+
	send_notification $1
	;;
down)
  amixer -q -D pulse sset Master 5%-
	send_notification $1
	;;
toggle)
  # amixer -q -D pulse sset Master toggle

	# if $(pamixer --get-mute); then
  if $(amixer -q -D pulse sset Master toggle); then

  # if [ "${curStatus}" = 'yes' ]
  # then

		dunstify -i volume-mute -a "changevolume" -t 2000 -r 9993 -u low "Mute toggled"
	else
		send_notification up
	fi
	;;
esac
